<script>
    let products = [];
    let defaultProducts = [];

    // Carica i prodotti dal file JSON
    async function loadProductsFromJSON() {
      try {
        const response = await fetch('./products.json');
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        defaultProducts = await response.json();
        console.log('Prodotti caricati dal file JSON:', defaultProducts.length);
        return defaultProducts;
      } catch (error) {
        console.warn('Impossibile caricare products.json, uso prodotti predefiniti:', error);
        // Fallback con prodotti predefiniti incorporati
        defaultProducts = [
          { name: "Stagno grezzo", price: 12, category: "Cristalli", subcategory: "Metalli", tier: "Novizio" },
          { name: "Rame grezzo", price: 20, category: "Cristalli", subcategory: "Metalli", tier: "Avanzato" },
          { name: "Ferro grezzo", price: 25, category: "Cristalli", subcategory: "Metalli", tier: "Esperto" },
          { name: "Oro grezzo", price: 50, category: "Cristalli", subcategory: "Metalli", tier: "Custode" },
          { name: "Carbone", price: 3, category: "Cristalli", subcategory: "Carburanti", tier: "Novizio" },
          { name: "Antracite", price: 6, category: "Cristalli", subcategory: "Carburanti", tier: "Esperto" },
          { name: "Lapis", price: 1, category: "Cristalli", subcategory: "Misto", tier: "Novizio" },
          { name: "Redstone", price: 1, category: "Cristalli", subcategory: "Misto", tier: "Novizio" },
          { name: "Ametista", price: 1.5, category: "Cristalli", subcategory: "Misto", tier: "Avanzato" },
          { name: "Withering Dust", price: 2.5, category: "Cristalli", subcategory: "Misto", tier: "Custode" },
          { name: "Core Fragment", price: 1, category: "Aberrazioni", tier: "Tutti" },
          { name: "Brim Powder", price: 1, category: "Aberrazioni", tier: "Novizio" },
          { name: "Carne Marcia", price: 1, category: "Aberrazioni", tier: "Novizio" },
          { name: "Revival star", price: 2, category: "Aberrazioni", tier: "Novizio" },
          { name: "Occhio di Ragno", price: 1, category: "Aberrazioni", tier: "Avanzato" },
          { name: "Quarzo", price: 1, category: "Aberrazioni", tier: "Avanzato" },
          { name: "Therium", price: 1, category: "Aberrazioni", tier: "Avanzato" },
          { name: "Blaze Powder", price: 2, category: "Aberrazioni", tier: "Esperto" },
          { name: "Membrana", price: 2, category: "Aberrazioni", tier: "Esperto" },
          { name: "Prismarine Shard", price: 2, category: "Aberrazioni", tier: "Custode" },
          { name: "Slime Ball", price: 2, category: "Aberrazioni", tier: "Custode" }
        ];
        return defaultProducts;
      }
    }