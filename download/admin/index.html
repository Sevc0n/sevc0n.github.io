<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - Cloud Storage</title>
  <link rel="icon" type="image/png" href="../../logo.png">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      min-height: 100vh;
      color: #ffffff;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: rgba(20, 25, 45, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      animation: slideIn 0.6s ease-out;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .admin-header {
      background: linear-gradient(135deg, #f56565, #e53e3e);
      padding: 30px;
      text-align: center;
      color: white;
    }

    .admin-header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    .admin-header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .content {
      padding: 40px;
    }

    .admin-nav {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
      flex-wrap: wrap;
    }

    .nav-btn {
      padding: 15px 25px;
      background: rgba(45, 55, 72, 0.5);
      border: none;
      border-radius: 10px 10px 0 0;
      color: #a0aec0;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
      font-weight: 600;
    }

    .nav-btn.active {
      background: linear-gradient(135deg, #f56565, #e53e3e);
      color: white;
      transform: translateY(-2px);
    }

    .nav-btn:hover:not(.active) {
      background: rgba(45, 55, 72, 0.8);
      color: #ffffff;
    }

    .admin-section {
      display: none;
    }

    .admin-section.active {
      display: block;
    }

    .upload-area {
      border: 2px dashed rgba(245, 101, 101, 0.5);
      border-radius: 15px;
      padding: 40px;
      text-align: center;
      background: rgba(245, 101, 101, 0.05);
      margin-bottom: 30px;
      transition: all 0.3s ease;
    }

    .upload-area:hover {
      border-color: rgba(245, 101, 101, 0.8);
      background: rgba(245, 101, 101, 0.1);
    }

    .upload-area.dragover {
      border-color: #f56565;
      background: rgba(245, 101, 101, 0.2);
      transform: scale(1.02);
    }

    .upload-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      color: #f56565;
    }

    .file-input {
      display: none;
    }

    .upload-btn {
      background: linear-gradient(135deg, #f56565, #e53e3e);
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1.1rem;
      margin: 10px;
    }

    .upload-btn:hover {
      background: linear-gradient(135deg, #e53e3e, #c53030);
      transform: translateY(-2px);
    }

    .file-list {
      background: rgba(45, 55, 72, 0.3);
      border-radius: 15px;
      padding: 20px;
      margin-top: 20px;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px;
      background: rgba(45, 55, 72, 0.5);
      border-radius: 10px;
      margin-bottom: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }

    .file-item:hover {
      background: rgba(45, 55, 72, 0.8);
      transform: translateX(5px);
    }

    .file-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .file-icon {
      font-size: 2rem;
    }

    .file-details h4 {
      color: #ffffff;
      margin-bottom: 5px;
    }

    .file-details p {
      color: #a0aec0;
      font-size: 0.9rem;
    }

    .file-actions {
      display: flex;
      gap: 10px;
    }

    .action-btn {
      padding: 8px 15px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .edit-btn {
      background: linear-gradient(135deg, #63b3ed, #4299e1);
      color: white;
    }

    .edit-btn:hover {
      background: linear-gradient(135deg, #4299e1, #3182ce);
      transform: translateY(-1px);
    }

    .delete-btn {
      background: linear-gradient(135deg, #f56565, #e53e3e);
      color: white;
    }

    .delete-btn:hover {
      background: linear-gradient(135deg, #e53e3e, #c53030);
      transform: translateY(-1px);
    }

    .move-btn {
      background: linear-gradient(135deg, #68d391, #48bb78);
      color: white;
    }

    .move-btn:hover {
      background: linear-gradient(135deg, #48bb78, #38a169);
      transform: translateY(-1px);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: rgba(45, 55, 72, 0.5);
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: #f56565;
      margin-bottom: 10px;
    }

    .stat-label {
      color: #a0aec0;
      font-size: 1.1rem;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      animation: fadeIn 0.3s ease;
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(20, 25, 45, 0.95);
      border-radius: 20px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .modal-header h3 {
      color: #f56565;
      font-size: 1.5rem;
    }

    .close-btn {
      background: none;
      border: none;
      color: #a0aec0;
      font-size: 1.5rem;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .close-btn:hover {
      color: #ffffff;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      color: #ffffff;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid rgba(245, 101, 101, 0.3);
      border-radius: 8px;
      background: rgba(45, 55, 72, 0.8);
      color: #ffffff;
      font-size: 1rem;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #f56565;
    }

    .modal-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 20px;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, #f56565, #e53e3e);
      color: white;
    }

    .btn-secondary {
      background: rgba(45, 55, 72, 0.8);
      color: #a0aec0;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .btn:hover {
      transform: translateY(-2px);
    }

    .back-link {
      display: inline-block;
      padding: 10px 20px;
      background: rgba(99, 179, 237, 0.1);
      border: 1px solid rgba(99, 179, 237, 0.3);
      color: #63b3ed;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      margin-top: 30px;
    }

    .back-link:hover {
      background: rgba(99, 179, 237, 0.2);
      transform: translateY(-1px);
    }

    .alert {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }

    .alert-success {
      background: rgba(72, 187, 120, 0.1);
      border: 1px solid rgba(72, 187, 120, 0.3);
      color: #68d391;
    }

    .alert-error {
      background: rgba(245, 101, 101, 0.1);
      border: 1px solid rgba(245, 101, 101, 0.3);
      color: #f56565;
    }

    @media (max-width: 768px) {
      .admin-nav {
        flex-direction: column;
      }
      
      .file-item {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .file-actions {
        justify-content: center;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="admin-header">
      <h1>
        ‚öôÔ∏è Admin Panel
        <span style="font-size: 1.5rem;">Cloud Storage</span>
      </h1>
      <p>Gestione completa dei file e del sistema</p>
    </div>

    <div class="content">
      <div class="admin-nav">
        <button class="nav-btn active" onclick="switchSection('dashboard')">üìä Dashboard</button>
        <button class="nav-btn" onclick="switchSection('upload')">‚¨ÜÔ∏è Upload File</button>
        <button class="nav-btn" onclick="switchSection('manage')">üìÅ Gestione File</button>
        <button class="nav-btn" onclick="switchSection('users')">üë• Utenti</button>
        <button class="nav-btn" onclick="switchSection('settings')">‚öôÔ∏è Impostazioni</button>
      </div>

      <!-- Dashboard -->
      <div id="dashboard" class="admin-section active">
        <h2 style="margin-bottom: 20px; color: #f56565;">üìä Dashboard Amministratore</h2>
        
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="totalFiles">0</div>
            <div class="stat-label">File Totali</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="publicFiles">0</div>
            <div class="stat-label">File Pubblici</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="secretFiles">0</div>
            <div class="stat-label">File Segreti</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalSize">0 MB</div>
            <div class="stat-label">Spazio Utilizzato</div>
          </div>
        </div>

        <div class="file-list">
          <h3 style="margin-bottom: 15px; color: #ffffff;">üìÅ File Recenti</h3>
          <div id="recentFiles">
            <p style="color: #a0aec0; text-align: center; padding: 20px;">Nessun file caricato di recente</p>
          </div>
        </div>
      </div>

      <!-- Upload File -->
      <div id="upload" class="admin-section">
        <h2 style="margin-bottom: 20px; color: #f56565;">‚¨ÜÔ∏è Carica Nuovi File</h2>
        
        <div class="upload-area" id="uploadArea">
          <div class="upload-icon">üìÅ</div>
          <h3 style="margin-bottom: 15px; color: #ffffff;">Trascina i file qui o clicca per selezionare</h3>
          <p style="color: #a0aec0; margin-bottom: 20px;">Supporta tutti i tipi di file</p>
          <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
            Scegli File
          </button>
          <input type="file" id="fileInput" class="file-input" multiple>
        </div>

        <div class="form-group">
          <label for="fileLocation">Posizione di destinazione:</label>
          <select id="fileLocation">
            <option value="public">üìÅ Area Pubblica</option>
            <option value="secret">üîí Area Segreta</option>
          </select>
        </div>

        <div class="form-group">
          <label for="fileDescription">Descrizione (opzionale):</label>
          <textarea id="fileDescription" rows="3" placeholder="Aggiungi una descrizione per il file..."></textarea>
        </div>

        <div class="alert alert-success" id="uploadSuccess">
          ‚úÖ File caricato con successo!
        </div>

        <div class="alert alert-error" id="uploadError">
          ‚ùå Errore durante il caricamento del file.
        </div>
      </div>

      <!-- Gestione File -->
      <div id="manage" class="admin-section">
        <h2 style="margin-bottom: 20px; color: #f56565;">üìÅ Gestione File</h2>
        
        <div class="file-list">
          <h3 style="margin-bottom: 15px; color: #ffffff;">üìÅ File Pubblici</h3>
          <div id="publicFileList">
            <div class="file-item">
              <div class="file-info">
                <span class="file-icon">üìÑ</span>
                <div class="file-details">
                  <h4>Documento.pdf</h4>
                  <p>2.4 MB ‚Ä¢ Caricato il 15/01/2024</p>
                </div>
              </div>
              <div class="file-actions">
                <button class="action-btn edit-btn" onclick="editFile('Documento.pdf', 'public')">‚úèÔ∏è Modifica</button>
                <button class="action-btn move-btn" onclick="moveFile('Documento.pdf', 'public')">üìÅ Sposta</button>
                <button class="action-btn delete-btn" onclick="deleteFile('Documento.pdf', 'public')">üóëÔ∏è Elimina</button>
              </div>
            </div>
            
            <div class="file-item">
              <div class="file-info">
                <span class="file-icon">üñºÔ∏è</span>
                <div class="file-details">
                  <h4>Immagine.jpg</h4>
                  <p>1.8 MB ‚Ä¢ Caricato il 14/01/2024</p>
                </div>
              </div>
              <div class="file-actions">
                <button class="action-btn edit-btn" onclick="editFile('Immagine.jpg', 'public')">‚úèÔ∏è Modifica</button>
                <button class="action-btn move-btn" onclick="moveFile('Immagine.jpg', 'public')">üìÅ Sposta</button>
                <button class="action-btn delete-btn" onclick="deleteFile('Immagine.jpg', 'public')">üóëÔ∏è Elimina</button>
              </div>
            </div>
          </div>
        </div>

        <div class="file-list" style="margin-top: 30px;">
          <h3 style="margin-bottom: 15px; color: #ffffff;">üîí File Segreti</h3>
          <div id="secretFileList">
            <div class="file-item">
              <div class="file-info">
                <span class="file-icon">üìã</span>
                <div class="file-details">
                  <h4>Report Confidenziale.pdf</h4>
                  <p>3.2 MB ‚Ä¢ Caricato il 13/01/2024</p>
                </div>
              </div>
              <div class="file-actions">
                <button class="action-btn edit-btn" onclick="editFile('Report Confidenziale.pdf', 'secret')">‚úèÔ∏è Modifica</button>
                <button class="action-btn move-btn" onclick="moveFile('Report Confidenziale.pdf', 'secret')">üìÅ Sposta</button>
                <button class="action-btn delete-btn" onclick="deleteFile('Report Confidenziale.pdf', 'secret')">üóëÔ∏è Elimina</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Gestione Utenti -->
      <div id="users" class="admin-section">
        <h2 style="margin-bottom: 20px; color: #f56565;">üë• Gestione Utenti</h2>
        <div style="text-align: center; padding: 40px; color: #a0aec0;">
          <h3 style="margin-bottom: 15px; color: #ffffff;">üöß In Sviluppo</h3>
          <p>La gestione utenti sar√† disponibile in una versione futura.</p>
        </div>
      </div>

      <!-- Impostazioni -->
      <div id="settings" class="admin-section">
        <h2 style="margin-bottom: 20px; color: #f56565;">‚öôÔ∏è Impostazioni Sistema</h2>
        <div style="text-align: center; padding: 40px; color: #a0aec0;">
          <h3 style="margin-bottom: 15px; color: #ffffff;">üöß In Sviluppo</h3>
          <p>Le impostazioni del sistema saranno disponibili in una versione futura.</p>
        </div>
      </div>

      <a href="../index.html" class="back-link">‚òÅÔ∏è Torna al Cloud Storage</a>
    </div>
  </div>

  <!-- Modal per modifica file -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>‚úèÔ∏è Modifica File</h3>
        <button class="close-btn" onclick="closeModal('editModal')">&times;</button>
      </div>
      <div class="form-group">
        <label for="editFileName">Nome File:</label>
        <input type="text" id="editFileName" placeholder="Nome del file">
      </div>
      <div class="form-group">
        <label for="editFileDescription">Descrizione:</label>
        <textarea id="editFileDescription" rows="3" placeholder="Descrizione del file..."></textarea>
      </div>
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="closeModal('editModal')">Annulla</button>
        <button class="btn btn-primary" onclick="saveFileEdit()">Salva Modifiche</button>
      </div>
    </div>
  </div>

  <!-- Modal per spostamento file -->
  <div id="moveModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>üìÅ Sposta File</h3>
        <button class="close-btn" onclick="closeModal('moveModal')">&times;</button>
      </div>
      <div class="form-group">
        <label for="moveFileLocation">Nuova Posizione:</label>
        <select id="moveFileLocation">
          <option value="public">üìÅ Area Pubblica</option>
          <option value="secret">üîí Area Segreta</option>
        </select>
      </div>
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="closeModal('moveModal')">Annulla</button>
        <button class="btn btn-primary" onclick="saveFileMove()">Sposta File</button>
      </div>
    </div>
  </div>

  <!-- Carica script di configurazione e API -->
  <script src="config.js"></script>
  <script src="github-api.js"></script>
  
  <script>
    // Inizializzazione
    let currentFiles = {
      public: [],
      secret: []
    };

    // Gestione sezioni admin
    function switchSection(sectionName) {
      // Rimuovi classe active da tutti i nav-btn e sezioni
      document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.admin-section').forEach(section => section.classList.remove('active'));
      
      // Aggiungi classe active al pulsante e sezione selezionati
      event.target.classList.add('active');
      document.getElementById(sectionName).classList.add('active');
      
      // Aggiorna dashboard se necessario
      if (sectionName === 'dashboard') {
        updateDashboard();
      }
    }

    // Aggiorna dashboard con statistiche
    function updateDashboard() {
      // Simula statistiche (in un'app reale, questi dati verrebbero dal server)
      document.getElementById('totalFiles').textContent = '12';
      document.getElementById('publicFiles').textContent = '8';
      document.getElementById('secretFiles').textContent = '4';
      document.getElementById('totalSize').textContent = '156.7 MB';
    }

    // Gestione upload file
    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('fileInput');

    // Drag and drop
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      const files = e.dataTransfer.files;
      handleFiles(files);
    });

    fileInput.addEventListener('change', (e) => {
      handleFiles(e.target.files);
    });

    async function handleFiles(files) {
      const location = document.getElementById('fileLocation').value;
      const description = document.getElementById('fileDescription').value;
      
      // Verifica configurazione
      const configValidation = validateConfig();
      if (!configValidation.valid) {
        showAlert('uploadError');
        console.error('Configurazione non valida:', configValidation.errors);
        alert('Configurazione GitHub non valida. Controlla config.js');
        return;
      }
      
      const uploadPromises = Array.from(files).map(async (file) => {
        try {
          // Genera nome file unico
          const timestamp = Date.now();
          const fileExtension = file.name.split('.').pop();
          const fileName = `${timestamp}_${file.name.replace(/[^a-zA-Z0-9.-]/g, '_')}`;
          const filePath = `${CONFIG.paths[location]}${fileName}`;
          
          // Upload file
          const result = await fileManager.uploadFile(file, filePath, `Upload ${file.name} to ${location}`);
          
          if (result.success) {
            console.log(`File ${file.name} caricato con successo`);
            return { success: true, file: file.name };
          } else {
            console.error(`Errore upload ${file.name}:`, result.error);
            return { success: false, file: file.name, error: result.error };
          }
        } catch (error) {
          console.error(`Errore upload ${file.name}:`, error);
          return { success: false, file: file.name, error: error.message };
        }
      });
      
      // Aspetta tutti gli upload
      const results = await Promise.all(uploadPromises);
      
      // Conta successi ed errori
      const successes = results.filter(r => r.success).length;
      const errors = results.filter(r => !r.success).length;
      
      if (successes > 0) {
        showAlert('uploadSuccess');
        // Aggiorna lista file
        await loadFiles();
        updateDashboard();
      }
      
      if (errors > 0) {
        showAlert('uploadError');
        console.error('Errori upload:', results.filter(r => !r.success));
      }
      
      // Reset form
      document.getElementById('fileDescription').value = '';
      document.getElementById('fileInput').value = '';
    }

    // Gestione modifica file
    function editFile(fileName, location) {
      document.getElementById('editFileName').value = fileName;
      document.getElementById('editFileDescription').value = 'Descrizione del file...';
      showModal('editModal');
    }

    function saveFileEdit() {
      const newName = document.getElementById('editFileName').value;
      const newDescription = document.getElementById('editFileDescription').value;
      
      console.log(`File renamed to: ${newName}`);
      console.log(`Description: ${newDescription}`);
      
      showAlert('uploadSuccess');
      closeModal('editModal');
    }

    // Gestione spostamento file
    function moveFile(fileName, currentLocation) {
      document.getElementById('moveFileLocation').value = currentLocation === 'public' ? 'secret' : 'public';
      showModal('moveModal');
    }

    function saveFileMove() {
      const newLocation = document.getElementById('moveFileLocation').value;
      console.log(`File moved to: ${newLocation}`);
      
      showAlert('uploadSuccess');
      closeModal('moveModal');
    }

    // Gestione eliminazione file
    function deleteFile(fileName, location) {
      if (confirm(`Sei sicuro di voler eliminare "${fileName}"?`)) {
        console.log(`File deleted: ${fileName} from ${location}`);
        showAlert('uploadSuccess');
        updateDashboard();
      }
    }

    // Gestione modal
    function showModal(modalId) {
      document.getElementById(modalId).style.display = 'block';
    }

    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
    }

    // Mostra alert
    function showAlert(alertId) {
      const alert = document.getElementById(alertId);
      alert.style.display = 'block';
      setTimeout(() => {
        alert.style.display = 'none';
      }, 3000);
    }

    // Carica file dalla repository
    async function loadFiles() {
      try {
        // Carica file pubblici
        const publicResult = await fileManager.listFiles(CONFIG.paths.public);
        if (publicResult.success) {
          currentFiles.public = publicResult.files.filter(file => file.type === 'file');
        }
        
        // Carica file segreti
        const secretResult = await fileManager.listFiles(CONFIG.paths.secret);
        if (secretResult.success) {
          currentFiles.secret = secretResult.files.filter(file => file.type === 'file');
        }
        
        // Aggiorna UI
        updateFileLists();
        
      } catch (error) {
        console.error('Errore caricamento file:', error);
      }
    }

    // Aggiorna le liste file nell'interfaccia
    function updateFileLists() {
      updateFileList('publicFileList', currentFiles.public, 'public');
      updateFileList('secretFileList', currentFiles.secret, 'secret');
    }

    // Aggiorna una lista file specifica
    function updateFileList(containerId, files, location) {
      const container = document.getElementById(containerId);
      
      if (files.length === 0) {
        container.innerHTML = '<p style="color: #a0aec0; text-align: center; padding: 20px;">Nessun file caricato</p>';
        return;
      }
      
      container.innerHTML = files.map(file => {
        const fileName = file.name;
        const fileSize = formatFileSize(file.size);
        const uploadDate = new Date(file.created_at).toLocaleDateString('it-IT');
        
        return `
          <div class="file-item">
            <div class="file-info">
              <span class="file-icon">${getFileIcon(fileName)}</span>
              <div class="file-details">
                <h4>${fileName}</h4>
                <p>${fileSize} ‚Ä¢ Caricato il ${uploadDate}</p>
              </div>
            </div>
            <div class="file-actions">
              <button class="action-btn edit-btn" onclick="editFile('${fileName}', '${location}')">‚úèÔ∏è Modifica</button>
              <button class="action-btn move-btn" onclick="moveFile('${fileName}', '${location}')">üìÅ Sposta</button>
              <button class="action-btn delete-btn" onclick="deleteFile('${fileName}', '${location}')">üóëÔ∏è Elimina</button>
            </div>
          </div>
        `;
      }).join('');
    }

    // Utility: formatta dimensione file
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 B';
      const k = 1024;
      const sizes = ['B', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    // Utility: ottieni icona file
    function getFileIcon(fileName) {
      const extension = fileName.split('.').pop().toLowerCase();
      const iconMap = {
        'pdf': 'üìÑ',
        'jpg': 'üñºÔ∏è', 'jpeg': 'üñºÔ∏è', 'png': 'üñºÔ∏è', 'gif': 'üñºÔ∏è',
        'doc': 'üìù', 'docx': 'üìù',
        'xls': 'üìä', 'xlsx': 'üìä',
        'ppt': 'üìä', 'pptx': 'üìä',
        'zip': 'üóúÔ∏è', 'rar': 'üóúÔ∏è', '7z': 'üóúÔ∏è',
        'txt': 'üìÑ', 'csv': 'üìä',
        'mp4': 'üé•', 'avi': 'üé•',
        'mp3': 'üéµ', 'wav': 'üéµ'
      };
      return iconMap[extension] || 'üìÑ';
    }

    // Inizializzazione
    window.addEventListener('load', async function() {
      // Verifica configurazione
      const configValidation = validateConfig();
      if (!configValidation.valid) {
        console.warn('Configurazione non valida:', configValidation.errors);
        alert('‚ö†Ô∏è Configurazione GitHub non valida!\n\nVai su config.js e inserisci:\n- Username GitHub\n- Nome repository\n- Personal Access Token');
      } else {
        // Carica file se configurazione valida
        await loadFiles();
      }
      
      updateDashboard();
      console.log('‚öôÔ∏è Admin Panel attivo');
    });
  </script>
</body>
</html>
